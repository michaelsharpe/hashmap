<% if @geomarker.errors.any? %>
  $('#geomarker-form-errors').html('<%= escape_javascript(render "geomarker_form_errors") %>' );
<% elsif @new_tags %>
  var id = <%= @geomarker.id %>;
  removeMarker(id);
  updateMarker(id);
  $(".tag-list").empty();
  $(".tag-list").append("<%= @geomarker.tag_list %>");
  $("#new-geomarker-tags").val("");
  $("#addTagButton").trigger("click");
<% else %>
  var id = <%= @geomarker.id %>;
  removeMarker(id);
  updateMarker(id);
  
  // with exception of getGeomarkerShow(), each of the following methods contains control flow to adapt to circumstances of update
  removeIFrame();
  removeGeomarkerShow();
  removeGeomarkerForm();
  getGeomarkerShow(id);
<% end %>